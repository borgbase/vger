# vger example configuration
# Copy this file to vger.yaml and adjust to your needs.

# Repositories to back up to.
# Top-level settings (encryption, compression, etc.) serve as defaults.
# Each repository entry can override: encryption, compression, retention,
# and source_directories.
# Select a single repo at runtime with: vger --repo <label-or-path>
repositories:
  - path: /backups/myrepo
    label: main

    # Storage backend: "local", "s3", or "rest" (default: "local")
    # backend: local

    # S3 backend settings (only used when backend is "s3")
    # s3_bucket: my-backup-bucket
    # s3_region: us-east-1
    # s3_endpoint: https://s3.amazonaws.com  # custom endpoint for S3-compatible stores

    # SFTP settings (not yet implemented)
    # sftp_host: backup.example.com
    # sftp_user: backupuser
    # sftp_port: 22

  # Additional repositories — uncomment to add a second destination:
  # - path: s3://bucket/remote
  #   label: remote
  #   backend: s3
  #   s3_bucket: my-bucket
  #   encryption:
  #     passcommand: "pass show vger-remote"
  #   compression:
  #     algorithm: zstd              # override: better ratio for remote
  #   retention:
  #     keep_daily: 30               # override: keep more on remote
  #   source_directories:            # override: subset for remote
  #     - /home/user/documents

# Encryption settings
encryption:
  # Mode: "aes256gcm" or "none" (default: "aes256gcm")
  mode: aes256gcm

  # Passphrase (optional — if omitted, vger will prompt interactively)
  # passphrase: my-secret-passphrase

  # Shell command that outputs the passphrase on stdout (optional)
  # passcommand: "cat /path/to/passphrase-file"

# Directories to back up
source_directories:
  - /home/user/documents
  - /home/user/photos

# Glob patterns to exclude from backups
exclude_patterns:
  - "*.tmp"
  - "*.cache"
  - ".DS_Store"
  - "node_modules"

# Snapshot name format (default: "{hostname}-{now:%Y-%m-%dT%H:%M:%S}")
snapshot_name_format: "{hostname}-{now:%Y-%m-%dT%H:%M:%S}"

# Content-defined chunking parameters (FastCDC)
chunker:
  min_size: 524288    # 512 KiB (default)
  avg_size: 2097152   # 2 MiB (default)
  max_size: 8388608   # 8 MiB (default)

# Compression settings
compression:
  # Algorithm: "lz4", "zstd", or "none" (default: "lz4")
  algorithm: lz4

  # Zstd compression level, 1-22 (default: 3, only used when algorithm is "zstd")
  zstd_level: 3

# Retention policy for `vger prune`
# At least one keep_* option must be set for prune to run.
# Snapshots matching multiple rules are kept (rules are additive).
retention:
  # Keep all snapshots created within this duration
  # Supported suffixes: h (hours), d (days), w (weeks), m (months ~30d), y (years ~365d)
  # A plain number is treated as days.
  keep_within: "2d"

  # Keep the N most recent snapshots
  keep_last: 5

  # Keep N snapshots per time bucket (newest in each bucket is kept)
  keep_hourly: 24
  keep_daily: 7
  keep_weekly: 4
  keep_monthly: 6
  keep_yearly: 2
